<h4 class="mb-4 d-flex justify-content-between align-items-center">
    <span><i class="bi bi-journal-text me-2 text-primary"></i>Chi tiết khóa học</span>
    <a href="/instructor" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-arrow-left me-1"></i> Quay lại bảng điều khiển
    </a>
</h4>

<div class="card border-0 shadow-sm p-4 mb-4">
    <div class="row align-items-center">
        <div class="col-md-4">
            <img src="{{course.image_url}}" alt="{{course.title}}" class="img-fluid rounded shadow-sm w-100"
                style="max-height: 300px; object-fit: cover;">
        </div>
        <div class="col-md-8">
            <h3 class="fw-bold">{{course.title}}</h3>
            <p class="text-muted mb-2">{{course.category_name}}</p>
            <p class="mb-2">{{course.description}}</p>
            <p class="mb-1"><strong>Thời lượng:</strong> {{course.total_hours}} giờ</p>
            <p class="mb-1"><strong>Tổng bài giảng:</strong> {{course.total_lectures}}</p>
            <p class="mb-1">
                <strong>Giá:</strong>
                <span class="text-decoration-line-through text-secondary">${{course.original_price}}</span>
                <span class="text-danger fw-semibold">${{course.current_price}}</span>
            </p>
            <p class="mb-0"><strong>Trạng thái:</strong>
                {{#if (eq course.status "complete")}}
                <span class="badge bg-success">Hoàn thành</span>
                {{else}}
                <span class="badge bg-warning text-dark">Chưa hoàn thành</span>
                {{/if}}
            </p>
        </div>
    </div>
</div>

<div class="card border-0 shadow-sm p-4 mb-4">
    <h5 class="fw-bold mb-3 text-primary">
        <i class="bi bi-person-badge-fill me-2"></i>Giảng viên
    </h5>

    <div class="d-flex align-items-center gap-3">
        {{#if course.instructor_avatar}}
        <img src="{{course.instructor_avatar}}" alt="Avatar" class="rounded-circle shadow-sm"
            style="width:90px; height:90px; object-fit:cover;">
        {{else}}
        <div class="rounded-circle bg-light d-flex align-items-center justify-content-center shadow-sm"
            style="width:90px; height:90px;">
            <i class="bi bi-person-circle fs-1 text-secondary"></i>
        </div>
        {{/if}}
        <div>
            <p class="fw-semibold mb-1">{{course.instructor_name}}</p>
            <p class="text-muted mb-0">{{course.instructor_bio}}</p>
        </div>
    </div>
</div>


{{!--Mô tả chi tiết --}}
{{#if course.detail_html}}
<div class="card border-0 shadow-sm p-4 mb-4">
    <h5 class="fw-bold mb-3 text-primary"><i class="bi bi-file-richtext me-2"></i>Mô tả chi tiết khóa học</h5>
    <div class="lh-lg">
        {{{course.detail_html}}}
    </div>
</div>
{{/if}}

{{!-- Nội dung khoá học--}}
<div class="card border-0 shadow-sm p-4">
    <h5 class="fw-bold mb-3 text-primary"><i class="bi bi-list-ul me-2"></i>Nội dung khóa học</h5>

    {{#if sections.length}}
    {{#each sections}}
    <div class="mb-4">
        <div class="fw-semibold mb-2">{{title}}</div>

        {{#each ../lectures}}
        {{#if (eq section_id ../section_id)}}
        <div class="ps-3 py-2 mb-2 border rounded-3">
            <div class="d-flex flex-wrap align-items-center justify-content-between">
                <div class="me-2">
                    <span class="fw-semibold">{{title}}</span>
                    {{#if is_preview}}<span class="badge bg-info text-dark ms-2">Xem thử</span>{{/if}}
                </div>
                <div class="text-muted small">
                    {{#if duration}}{{duration}} phút{{else}}—{{/if}}
                </div>
            </div>

            {{#if video_url}}

            {{#if (includes video_url "/uploads/videos/")}}
            <details class="mt-2">
                <summary class="text-primary" style="cursor:pointer;">
                    <i class="bi bi-play-circle me-1"></i>Xem video
                </summary>
                <div class="mt-2">
                    <video controls playsinline class="w-100 rounded-3 shadow-sm" style="max-height: 480px;">
                        <source src="{{video_url}}" type="video/mp4">
                        Trình duyệt không hỗ trợ phát video.
                    </video>
                </div>
            </details>
            {{else}}

            <div class="mt-2">
                <a href="{{video_url}}" target="_blank"
                    class="btn btn-sm btn-outline-primary d-inline-flex align-items-center gap-2">
                    <i class="bi bi-box-arrow-up-right"></i> Xem trên YouTube
                </a>
            </div>
            {{/if}}
            {{else}}
            <div class="mt-2 small text-muted">Chưa có video cho bài giảng này.</div>
            {{/if}}
        </div>
        {{/if}}
        {{/each}}
    </div>
    {{/each}}
    {{else}}
    <p class="text-muted fst-italic mb-0">Chưa có nội dung chương/bài giảng.</p>
    {{/if}}
</div>

<div class="mt-4 text-end">
    <a href="/instructor/dashboard" class="btn btn-outline-secondary">Quay lại</a>
    <a href="/instructor/edit/{{course.course_id}}" class="btn btn-primary">Chỉnh sửa</a>
</div>